<div class="bloco_conteudo bloco_central_80" md-whiteframe="1dp">
	<md-tabs md-dynamic-height md-border-bottom>
		<md-tab label="Dados">
			<md-content class="md-padding">
				<h1 class="md-display-2">Dados do Projeto</h1>
				<form name="form_projetoInfo" novalidate>
					<div layout="column">
						<div layout="row" layout-align="space-between start" class="md-inline-form">
							<md-input-container flex="30">
								<label>Nome</label>
								<input type="text" placeholder="Dê um nome para o projeto" ng-model="projeto.nome" required>
							</md-input-container>
							
							<md-input-container flex="30">
								<label>Código</label>
								<input type="text" placeholder="Digite um código identificador para o projeto" ng-model="projeto.codigo" required>
							</md-input-container>

							<md-input-container flex="30">
								<label>Cliente</label>
								<md-select ng-model="clientes.selecionado" required> <!--md-on-close: expression; multiple:boolean; placeholder: string;-->
								  <md-select-label>Selecione um cliente</md-select-label>
								  <md-option ng-value="option" ng-repeat="option in clientes.dados">{{ option.nome }}</md-option>
								</md-select>
							</md-input-container>
						</div>
						<div layout="row"  layout-align="space-between start" class="md-inline-form">
							<md-input-container flex="30">
								<label>Responsável</label>
								<md-select ng-model="usuarios.selecionado" required>
								  <md-select-label>Selecione um responsável</md-select-label>
								  <md-option ng-value="option" ng-repeat="option in usuarios.dados|orderBy:'nome'">{{ option.nome }}</md-option>
								</md-select>
							</md-input-container>
							<md-input-container flex="30">
								<label>Início (previsto)</label>
								<md-datepicker
												md-open-on-focus
												md-hide-icons="calendar"
												ng-model="projeto.data_inicio_p"
												></md-datepicker>
							</md-input-container>
							<md-input-container flex="30">
								<label>Final (previsto)</label>
								<md-datepicker
												md-open-on-focus
												md-hide-icons="calendar"
												ng-model="projeto.data_final_p"
												></md-datepicker></td>
							</md-input-container>
						</div>
						<div layout="row">
							<md-input-container flex="45">
								<md-checkbox name="ativo" ng-model="projeto.ativo" class="md-primary">
									Ativo
								</md-checkbox>
							</md-input-container>
						</div>
					</div>
					<div layout="row" layout-align="end start">
						<md-button class="md-raised md-accent" ng-click="cancel()">Cancelar</md-button>
						<md-button class="md-raised md-primary" ng-click="salvarProjeto()" ng-disabled="form_projetoInfo.$pristine || clientes.selecionado.id==0 || usuarios.selecionado.id==0 || !form_projetoInfo.$valid">Salvar</md-button>
					</div>
				</form>
			</md-content>
		</md-tab>

		<md-tab label="Áreas" ng-disabled="projeto.id==0">
			<md-content class="md-padding" ng-controller="ProjetosAreasController">
				<h1 class="md-display-2">Áreas do Projeto</h1>
				<div layout="row" layout-align="space-between center">
					<md-button class="md-raised md-primary" aria-label="Nova Área" ng-click="openAreaDialog($event,0)">Nova Área</md-button>
					<md-input-container>
						<label>Buscar por Área</label>
						<md-icon class="material-icons step" aria-label="Buscar Área">search</md-icon>
						<input type="text" ng-model="qArea" placeholder="Digite">
					</md-input-container>
				</div>
				<table>
					<thead>
						<tr>
							<td>Cód. da Área</td>
							<td>Nome da Área</td>
							<td></td>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="area in projeto.areas|filter:qArea">
							<!-- Campo de código -->
							<td ng-if="area.id!=areaEditada.id">{{area.codigo}}</td>
							<td ng-if="area.id==areaEditada.id"><input type="text" ng-model="areaEditada.codigo" id="codigo_area_{{area.id}}"></td>
							
							<!-- Campo de nome -->
							<td ng-if="area.id!=areaEditada.id">{{area.nome}}</td>
							<td ng-if="area.id==areaEditada.id"><input type="text" ng-model="areaEditada.nome" id="nome_area_{{area.id}}"></td>
							
							<!-- Botões-->
							<td>
								<md-button class="md-icon-button" aria-label="Remover Área" ng-click="openConfirm($event,area.id)">
									<md-icon class="material-icons step" aria-label="Remover Área">delete</md-icon>
								</md-button>
								<md-button class="md-icon-button" aria-label="Alterar Área" ng-click="openAreaDialog($event,area.id)">
									<md-icon class="material-icons step" aria-label="Alterar Área">mode_edit</md-icon>
								</md-button>
							</td>
						</tr>
					</tbody>
				</table>
			</md-content>
		</md-tab>

		<md-tab label="Documentos de Abertura de Operações" ng-disabled="projeto.id==0">
			<md-content class="md-padding" ng-controller="ProjetosDAOsController">
				<h1 class="md-display-2">Documentos de Abertura de Operações</h1>
				<form id="form_daos" name="form_daos" novalidate>
					<button ngf-select ng-model="daoFiles" ngf-multiple="true" ng-model="daoFiles" class="bt_upload" ng-disabled="daoFiles.length>0">Selecione Documentos de Abertura de Operções ...</button>
					<table ng-if="daoFiles.length>0">
						<thead>
							<tr>
								<td>Nome do Documento</td>
								<td>Arquivo</td>
								<td></td>
								<td></td>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="file in daoFiles" id="tr_{{file.name}}">
								<td><input type="text" name="daoName_{{$index}}" ng-model="daoNames[$index]" required></td>
								<td>{{file.name}}</td>
								<td>{{errosNoUploadDeDaos[$index]}}</td>
								<td><button class="bt_cancelar" ng-click="removerDaoFile($index)">Remover</button></td>
							</tr>
						</tbody>
					</table>
					<div ng-if="mostrarProgressoUploadDaos" class="progress_bar">
						<div style="width:{{progress}}%">
							<span>{{progress}}%</span>	
						</div>
					</div>
					<button	class="bt_salvar" ng-click="uploadDaoFiles(daoFiles)" ng-if="daoFiles.length>0" ng-disabled="daoFiles.length==0 || !form_daos.$valid">Salvar Documentos de Abertura de Operações</button>
				</form>
				<div class="sub_bloco">
					<h3>Já registrados</h3>
					<table>
						<thead>
							<tr>
								<td>Nome</td>
								<td>Arquivo</td>
								<td>Tipo</td>
								<td>Tamanho</td>
								<td></td>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="dao in projeto.daos">
								<td>{{dao.nome}}</td>
								<td>{{dao.nome_cliente}}</td>
								<td>{{dao.tipo}}</td>
								<td>{{dao.tamanho}}</td>
								<td><button class="bt_cancelar" ng-click="removerDAO(dao.id)">Remover</button></td>
							</tr>
						</tbody>
					</table>
				</div>
			</md-content>
		</md-tab>

		<md-tab label="Documentos" ng-disabled="projeto.id==0">
			<md-content class="md-padding" ng-controller="ProjetosDocumentosController">
				<h1 class="md-display-2">Documentos</h1>
				<div layout="row" layout-align="space-between center">
					<md-button class="md-raised md-primary" aria-label="Novo Documento" ng-click="openDocumentoDialog($event,0)">Novo Documento</md-button>
					<md-input-container>
						<label>Buscar por Documento</label>
						<md-icon class="material-icons step" aria-label="Buscar documento">search</md-icon>
						<input type="text" ng-model="qDoc.nome" placeholder="Digite">
					</md-input-container>
				</div>
				<table>
					<thead>
						<tr>
							<td>Nome</td>
							<td>Subdisciplina</td>
							<td>Área</td>
							<td>Data Limite</td>
							<td>Dependências</td>
							<td></td>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="doc in projeto.documentos|filter:qDoc.nome">
							<!-- Campo de nome -->
							<td ng-if="doc.id != documentoEditado.id">{{doc.nome}}</td>
							<td ng-if="doc.id == documentoEditado.id"><input focus type="text" id="nome_documento_{{documentoEditado.id}}" ng-model="documentoEditado.nome"></td>

							<!-- campo de subdisciplina -->
							<td ng-if="doc.id != documentoEditado.id">{{doc.nome_subdisciplina}}<span>{{doc.nome_disciplina}}</span></td>
							<td ng-if="doc.id == documentoEditado.id"><select ng-model="srcSubdisciplinas.selected" ng-options="option.nome group by option.nome_disciplina for option in srcSubdisciplinas.data track by option.id"></select></td>

							<!-- campo de area -->
							<td ng-if="doc.id != documentoEditado.id">{{doc.nome_area}}</td>
							<td ng-if="doc.id == documentoEditado.id">
								<select ng-model="srcAreas.selected" ng-options="option.nome for option in projeto.areas">
									<option value="">Selecione...</option>		
								</select>
							</td>
							
							<!-- Campos de data_limite -->
							<td ng-if="doc.id != documentoEditado.id">{{doc.data_limite|date:'dd/MM/yyyy'}}</td>
							<td ng-if="doc.id == documentoEditado.id">
									<md-datepicker
											md-open-on-focus
											md-hide-icons="calendar"
											ng-model="documentoEditado.data_limite"
											></md-datepicker></td>
							
							<!-- Campos de dependências -->
							<td ng-if="doc.id != documentoEditado.id">
								{{doc.dependencias|nomesDasDependencias}}
							</td>
							<td ng-if="doc.id == documentoEditado.id">
								<tags-input ng-model="documentoEditado.dependencias" display-property="nome" add-from-autocomplete-only="true" placeholder="Digite...">
									<auto-complete source="getDependenciasPossiveis($query,documentoEditado)"></auto-complete>
								</tags-input>
							</td>

							<!-- botões de ação sobre o documento -->
							<td>
								<md-button class="md-icon-button" aria-label="Remover Documento" ng-click="openConfirm($event,doc.id)">
									<md-icon class="material-icons step" aria-label="Remover Área">delete</md-icon>
								</md-button>
								<md-button class="md-icon-button" aria-label="Alterar Documento" ng-click="openDialog($event,doc.id)">
									<md-icon class="material-icons step" aria-label="Alterar Documento">mode_edit</md-icon>
								</md-button>
							</td>
						</tr>
				</table>
			</md-content>
		</md-tab>
	</md-tabs>
</div>